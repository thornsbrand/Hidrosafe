{% extends "base.html" %}

{% block title %}Perfil - Hydrosafe{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2>Perfil de Usuario</h2>
    <p>Bienvenido, <strong>{{ user.email }}</strong></p>

    <form>
        <div class="mb-3">
            <label class="form-label">Correo Electrónico</label>
            <input type="email" class="form-control" value="{{ user.email }}" disabled>
        </div>
        
        <div class="mb-3">
            <label class="form-label">Nueva Contraseña</label>
            <input type="password" id="newPassword" class="form-control" placeholder="Ingrese nueva contraseña">
        </div>

        <button type="button" class="btn btn-primary" onclick="updatePassword()">Actualizar Contraseña</button>
    </form>
</div>

<!-- 🚀 Agregar Firebase en modo compatibilidad -->
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>

<script>
    // 🔹 Configuración de Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyADxmST-tVzWPery7a7tYksjeBNKlbYMxk",
        authDomain: "hydrosafe-b8635.firebaseapp.com",
        projectId: "hydrosafe-b8635",
        storageBucket: "hydrosafe-b8635.appspot.com",
        messagingSenderId: "670282184676",
        appId: "1:670282184676:web:1cda5088c7cca03e6fb9f1",
        measurementId: "G-P79J6CG5S8"
    };

    // 🔹 Inicializar Firebase si aún no está inicializado
    if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }
</script>

<script>
    function updatePassword() {
        if (typeof firebase === "undefined") {
            alert("Error: Firebase no está disponible.");
            return;
        }

        const newPassword = document.getElementById("newPassword").value;

        if (!newPassword) {
            alert("Ingrese una nueva contraseña.");
            return;
        }

        const user = firebase.auth().currentUser;
        if (!user) {
            alert("Error: No hay un usuario autenticado.");
            return;
        }

        user.updatePassword(newPassword)
            .then(() => {
                alert("Contraseña actualizada con éxito.");
            })
            .catch((error) => {
                alert("Error al actualizar la contraseña: " + error.message);
            });
    }
</script>


{% endblock %}
